<!DOCTYPE html>
<html lang="ru" data-theme="blue">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=1,user-scalable=no">
<meta name="apple-mobile-web-app-capable" content="yes">
<meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
<title>Nexus</title>
<link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800;900&display=swap" rel="stylesheet">
<style>
/* ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
   THEMES & CORE
‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê */
[data-theme="blue"]{
  --acc:#2b8af5;--acc2:#1e5fd4;--accH:#3b9bff;
  --accS:rgba(43,138,245,.15);--accG:linear-gradient(135deg,#2b8af5,#7c5ce4);
  --glow:0 0 30px rgba(43,138,245,.4);
}
[data-theme="purple"]{
  --acc:#8b5cf6;--acc2:#6d28d9;--accH:#a78bfa;
  --accS:rgba(139,92,246,.15);--accG:linear-gradient(135deg,#8b5cf6,#ec4899);
  --glow:0 0 30px rgba(139,92,246,.4);
}
[data-theme="green"]{
  --acc:#10b981;--acc2:#059669;--accH:#34d399;
  --accS:rgba(16,185,129,.15);--accG:linear-gradient(135deg,#10b981,#2b8af5);
  --glow:0 0 30px rgba(16,185,129,.4);
}
[data-theme="red"]{
  --acc:#ef4444;--acc2:#dc2626;--accH:#f87171;
  --accS:rgba(239,68,68,.15);--accG:linear-gradient(135deg,#ef4444,#f97316);
  --glow:0 0 30px rgba(239,68,68,.4);
}
[data-theme="gold"]{
  --acc:#f59e0b;--acc2:#d97706;--accH:#fbbf24;
  --accS:rgba(245,158,11,.15);--accG:linear-gradient(135deg,#f59e0b,#ef4444);
  --glow:0 0 30px rgba(245,158,11,.4);
}

:root{
  --bg:#080a12;--bg2:#0d1120;--bg3:#111827;--bg4:#1a2035;--bg5:#1e2640;
  --brd:rgba(43,138,245,.1);--brd2:rgba(43,138,245,.2);--brd3:rgba(255,255,255,.06);
  --grn:#22c55e;--red:#f87171;--ylw:#fbbf24;--org:#fb923c;
  --tx:#dde4f5;--tx2:#7a8fb5;--tx3:#3d4f70;
  --out:#0e2050;--outB:rgba(43,138,245,.3);
  --in:#111827;--inB:rgba(255,255,255,.05);
  --sb:300px;--ease:cubic-bezier(.4,0,.2,1);--t:.18s;
  --safe:env(safe-area-inset-bottom,0px);
  --shadow:0 8px 32px rgba(0,0,0,.6);
  --shadow2:0 2px 12px rgba(0,0,0,.4);
}
*{margin:0;padding:0;box-sizing:border-box;-webkit-tap-highlight-color:transparent;}
html,body{height:100%;height:-webkit-fill-available;overflow:hidden;font-family:'Inter',sans-serif;background:var(--bg);color:var(--tx);-webkit-font-smoothing:antialiased;}

/* ‚ïê‚ïê FIX: Overlap Bug ‚ïê‚ïê */
.sb-title, .ph-logo-name, .auth-title {
  line-height: 1.2 !important;
  margin: 0 !important;
  display: block;
}

.sb-brand {
  display: flex;
  align-items: center;
  gap: 9px;
  flex: 1;
  min-width: 0;
  overflow: hidden; /* –ü—Ä–µ–¥–æ—Ç–≤—Ä–∞—â–∞–µ—Ç –≤—ã–µ–∑–¥ —Ç–µ–∫—Å—Ç–∞ */
}

/* ‚ïê‚ïê REST OF CSS (—Å–æ–∫—Ä–∞—â–µ–Ω–æ –¥–ª—è –∫—Ä–∞—Ç–∫–æ—Å—Ç–∏, –æ—Å—Ç–∞–≤—å —Å–≤–æ–π –æ—Ä–∏–≥–∏–Ω–∞–ª —Ç—É—Ç) ‚ïê‚ïê */
.particles{position:fixed;inset:0;pointer-events:none;z-index:0;overflow:hidden;}
.particle{position:absolute;border-radius:50%;animation:pFloat linear infinite;opacity:0;}
@keyframes pFloat{0%{transform:translateY(100vh)rotate(0);opacity:0;}10%{opacity:.4;}90%{opacity:.2;}100%{transform:translateY(-100px)rotate(720deg);opacity:0;}}

/* ... (–ó–¥–µ—Å—å –¥–æ–ª–∂–Ω—ã –±—ã—Ç—å –≤—Å–µ —Ç–≤–æ–∏ —Å—Ç–∏–ª–∏ –∏–∑ –æ—Ä–∏–≥–∏–Ω–∞–ª—å–Ω–æ–≥–æ —Ñ–∞–π–ª–∞) ... */

/* –ú–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ (Mov) */
.mov{position:fixed;inset:0;background:rgba(0,0,0,.7);backdrop-filter:blur(10px);display:flex;align-items:center;justify-content:center;z-index:500;opacity:0;pointer-events:none;transition:all .2s;}
.mov.open{opacity:1;pointer-events:auto;}
.modal{background:var(--bg2);border:1px solid var(--brd2);border-radius:24px;width:90%;padding:24px;position:relative;transform:scale(.9);transition:all .2s;}
.mov.open .modal{transform:none;}
.mhdr{display:flex;justify-content:space-between;align-items:center;margin-bottom:20px;}
.mx{background:none;border:none;color:var(--tx3);font-size:20px;cursor:pointer;}
.mftr{display:flex;justify-content:flex-end;gap:10px;margin-top:24px;}
.mc{background:var(--bg4);border:none;padding:10px 20px;border-radius:12px;color:var(--tx2);cursor:pointer;}
.mo{background:var(--accG);border:none;padding:10px 20px;border-radius:12px;color:#fff;cursor:pointer;font-weight:600;}

/* –ü–æ–ª—è –≤–≤–æ–¥–∞ –≤ –º–æ–¥–∞–ª–∫–∞—Ö */
.afield{position:relative;margin-bottom:12px;}
.ainp{width:100%;background:var(--bg4);border:1px solid var(--brd);border-radius:12px;padding:12px 15px;color:var(--tx);font-size:14px;}
.ainp.pre{padding-left:30px;}
.afield-pre{position:absolute;left:12px;top:50%;transform:translateY(-50%);color:var(--tx3);font-weight:700;}
.aerr{color:var(--red);font-size:12px;margin-top:5px;}
.hidden{display:none;}
</style>
</head>
<body>

<div id="app" class="show">
  <div class="sb" id="sidebar">
    <div class="sb-head">
      <div class="sb-top">
        <div class="sb-brand">
          <div class="sb-logo">N</div>
          <h1 class="sb-title">Nexus</h1>
        </div>
        <button class="ib" onclick="openMov('nc-mov')">Ôºã</button>
      </div>
      <div class="sb-srch">
        <span class="sb-si">üîç</span>
        <input type="text" class="sb-inp" placeholder="–ü–æ–∏—Å–∫ –ø–æ username..." id="main-search">
      </div>
    </div>
    <div class="chat-list" id="chat-list">
      </div>
    <div class="sb-foot" onclick="openSettings()">
      <div class="ava"><div class="av av-md" id="me-ava">U</div></div>
      <div class="me-inf">
        <div class="me-name" id="me-name">Username</div>
        <div class="me-status">–æ–Ω–ª–∞–π–Ω</div>
      </div>
    </div>
  </div>

  <div class="main">
    <div class="placeholder" id="main-placeholder">
       <div class="ph-logo-wrap">
          <div class="ph-logo-box"><div class="ph-logo-inner">N</div></div>
          <h2 class="ph-logo-name">Nexus Messenger</h2>
       </div>
       <p class="ph-s">–í—ã–±–µ—Ä–∏—Ç–µ —á–∞—Ç, —á—Ç–æ–±—ã –Ω–∞—á–∞—Ç—å –æ–±—â–µ–Ω–∏–µ</p>
    </div>
    <div id="chat-window" style="display:none; flex:1; flex-direction:column;">
       </div>
  </div>
</div>

<div class="mov" id="add-acc-mov">
  <div class="modal" style="max-width:400px">
    <div class="mhdr"><h3>‚ûï –î–æ–±–∞–≤–∏—Ç—å/–°–æ–∑–¥–∞—Ç—å –∞–∫–∫–∞—É–Ω—Ç</h3><button class="mx" onclick="closeMov('add-acc-mov')">‚úï</button></div>
    <div class="afield"><span class="afield-pre">@</span><input class="ainp pre" type="text" id="aa-un" placeholder="username"></div>
    <div class="afield"><span class="afield-ic">üîí</span><input class="ainp ic" type="password" id="aa-pw" placeholder="–ü–∞—Ä–æ–ª—å"></div>
    <div class="aerr hidden" id="aa-err">‚ùå <span id="aa-err-t"></span></div>
    <p style="font-size: 11px; color: var(--tx3); margin-bottom: 15px;">–ï—Å–ª–∏ –∞–∫–∫–∞—É–Ω—Ç –Ω–µ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç, –æ–Ω –±—É–¥–µ—Ç —Å–æ–∑–¥–∞–Ω –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏.</p>
    <div class="mftr">
      <button class="mc" onclick="closeMov('add-acc-mov')">–û—Ç–º–µ–Ω–∞</button>
      <button class="mo" onclick="addAccount()">–°–æ–∑–¥–∞—Ç—å / –í–æ–π—Ç–∏</button>
    </div>
  </div>
</div>

<div class="mov" id="nc-mov">
  <div class="modal" style="max-width:400px">
    <div class="mhdr"><h3>üì¢ –°–æ–∑–¥–∞—Ç—å –∫–∞–Ω–∞–ª</h3><button class="mx" onclick="closeMov('nc-mov')">‚úï</button></div>
    <div class="afield"><input class="ainp" type="text" id="nc-name" placeholder="–ù–∞–∑–≤–∞–Ω–∏–µ –∫–∞–Ω–∞–ª–∞"></div>
    <div class="mftr">
      <button class="mc" onclick="closeMov('nc-mov')">–û—Ç–º–µ–Ω–∞</button>
      <button class="mo" onclick="createChannel()">–°–æ–∑–¥–∞—Ç—å</button>
    </div>
  </div>
</div>

<script>
/* ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ –î–ê–ù–ù–´–ï (–ó–∞–≥–ª—É—à–∫–∏) ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ */
let me = { id: '1', username: 'user', name: '–Ø' };
let chats = [];
let allUsers = [
    { id: '2', username: 'alex_p', name: '–ê–ª–µ–∫—Å–∞–Ω–¥—Ä' },
    { id: '3', username: 'maria_design', name: '–ú–∞—Ä–∏—è' },
    { id: '4', username: 'dev_guy', name: '–†–∞–∑—Ä–∞–±–æ—Ç—á–∏–∫' }
];
let accounts = [ { token: 'tok1', user: me } ];

/* ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ –§–£–ù–ö–¶–ò–ò ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ */

function openMov(id){ document.getElementById(id).classList.add('open'); }
function closeMov(id){ document.getElementById(id).classList.remove('open'); }

// 1. –ò–°–ü–†–ê–í–õ–ï–ù–ù–û–ï –î–û–ë–ê–í–õ–ï–ù–ò–ï –ê–ö–ö–ê–£–ù–¢–ê (–†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è + –í—Ö–æ–¥)
async function addAccount() {
    const un = document.getElementById('aa-un').value.trim();
    const pw = document.getElementById('aa-pw').value;
    const errEl = document.getElementById('aa-err');
    const errT = document.getElementById('aa-err-t');

    if(!un || !pw) return;

    // –ü—ã—Ç–∞–µ–º—Å—è —Å–Ω–∞—á–∞–ª–∞ –∑–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞—Ç—å (–°–æ–∑–¥–∞—Ç—å)
    // –í —Ä–µ–∞–ª—å–Ω–æ–º API –∑–¥–µ—Å—å –±—ã–ª –±—ã –∑–∞–ø—Ä–æ—Å –∫ /register
    console.log("–ü–æ–ø—ã—Ç–∫–∞ —Å–æ–∑–¥–∞–Ω–∏—è/–≤—Ö–æ–¥–∞ –¥–ª—è:", un);
    
    // –ò–º–∏—Ç–∞—Ü–∏—è –ª–æ–≥–∏–∫–∏: –µ—Å–ª–∏ —é–∑–µ—Ä–∞ –Ω–µ—Ç –≤ –±–∞–∑–µ - —Å–æ–∑–¥–∞–µ–º, –µ—Å–ª–∏ –µ—Å—Ç—å - –≤—Ö–æ–¥–∏–º
    let existingUser = allUsers.find(u => u.username === un);
    
    if(!existingUser) {
        // "–°–æ–∑–¥–∞–µ–º"
        existingUser = { id: Date.now().toString(), username: un, name: un };
        allUsers.push(existingUser);
        alert("–ê–∫–∫–∞—É–Ω—Ç @" + un + " —É—Å–ø–µ—à–Ω–æ —Å–æ–∑–¥–∞–Ω!");
    }

    // –ò–º–∏—Ç–∏—Ä—É–µ–º —É—Å–ø–µ—à–Ω—ã–π –≤—Ö–æ–¥
    const newAcc = { token: 'tok_' + Math.random(), user: existingUser };
    accounts.push(newAcc);
    
    // –ü–µ—Ä–µ–∫–ª—é—á–∞–µ–º—Å—è –Ω–∞ –Ω–æ–≤—ã–π –∞–∫–∫–∞—É–Ω—Ç
    me = existingUser;
    updateUI();
    closeMov('add-acc-mov');
}

// 2. –ò–°–ü–†–ê–í–õ–ï–ù–ù–´–ô –ü–û–ò–°–ö –ü–û USERNAME
document.getElementById('main-search').addEventListener('input', e => {
    const q = e.target.value.toLowerCase().trim();
    const chatListEl = document.getElementById('chat-list');
    
    if (!q) {
        renderChatList(chats);
        return;
    }

    // –ò—â–µ–º –∏ –≤ —á–∞—Ç–∞—Ö, –∏ –≤ –≥–ª–æ–±–∞–ª—å–Ω–æ–º —Å–ø–∏—Å–∫–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
    const filteredUsers = allUsers.filter(u => 
        u.username.toLowerCase().includes(q) || u.name.toLowerCase().includes(q)
    );

    // –û—Ç—Ä–∏—Å–æ–≤–∫–∞ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤
    let html = '<div class="sec-l">–†–µ–∑—É–ª—å—Ç–∞—Ç—ã –ø–æ–∏—Å–∫–∞</div>';
    if(filteredUsers.length === 0) {
        html += '<div class="empty-sb">–ù–∏—á–µ–≥–æ –Ω–µ –Ω–∞–π–¥–µ–Ω–æ</div>';
    } else {
        filteredUsers.forEach(u => {
            html += `
            <div class="ci" onclick="startChatWith('${u.id}')">
                <div class="ava"><div class="av av-md" style="background:#555">${u.name[0]}</div></div>
                <div class="ci-info">
                    <div class="ci-name">@${u.username}</div>
                    <div class="ci-prev">${u.name}</div>
                </div>
            </div>`;
        });
    }
    chatListEl.innerHTML = html;
});

// 3. –ò–°–ü–†–ê–í–õ–ï–ù–ù–û–ï –°–û–ó–î–ê–ù–ò–ï –ö–ê–ù–ê–õ–ê (–ê–¥–º–∏–Ω –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é)
function createChannel() {
    const name = document.getElementById('nc-name').value.trim();
    if(!name) return;

    const newChannel = {
        id: 'ch_' + Date.now(),
        name: name,
        type: 'channel',
        ownerId: me.id,
        admins: [me.id], // <--- –ò–°–ü–†–ê–í–õ–ï–ù–û: –°–æ–∑–¥–∞—Ç–µ–ª—å —Å—Ä–∞–∑—É –∞–¥–º–∏–Ω
        members: [me.id],
        messages: []
    };

    chats.unshift(newChannel);
    renderChatList(chats);
    closeMov('nc-mov');
    alert("–ö–∞–Ω–∞–ª '" + name + "' —Å–æ–∑–¥–∞–Ω. –í—ã –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä.");
}

function renderChatList(list) {
    const el = document.getElementById('chat-list');
    if(list.length === 0) {
        el.innerHTML = '<div class="empty-sb">–£ –≤–∞—Å –ø–æ–∫–∞ –Ω–µ—Ç —á–∞—Ç–æ–≤</div>';
        return;
    }
    el.innerHTML = list.map(c => `
        <div class="ci">
            <div class="ava"><div class="av av-md" style="background:var(--accG)">${c.name[0]}</div></div>
            <div class="ci-info">
                <div class="ci-name">${c.name} ${c.type==='channel'?'üì¢':''}</div>
                <div class="ci-prev">–ù–∞–∂–º–∏—Ç–µ, —á—Ç–æ–±—ã –æ—Ç–∫—Ä—ã—Ç—å</div>
            </div>
        </div>
    `).join('');
}

function updateUI() {
    document.getElementById('me-name').textContent = me.name;
    document.getElementById('me-ava').textContent = me.name[0];
}

function startChatWith(userId) {
    const user = allUsers.find(u => u.id === userId);
    if(!chats.find(c => c.userId === userId)) {
        chats.unshift({ id: 'chat_'+Date.now(), name: user.name, type: 'private', userId: userId });
    }
    document.getElementById('main-search').value = '';
    renderChatList(chats);
}

// –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è
updateUI();
renderChatList(chats);

</script>
</body>
</html>